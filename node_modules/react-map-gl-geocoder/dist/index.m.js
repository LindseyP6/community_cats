import{PureComponent as e}from"react";import o from"prop-types";import n from"@mapbox/mapbox-gl-geocoder";import{FlyToInterpolator as r}from"react-map-gl";import t from"viewport-mercator-project";var i=["top-left","top-right","bottom-left","bottom-right"],c=function(e){var o,c;function l(){for(var o,c=arguments.length,l=new Array(c),a=0;a<c;a++)l[a]=arguments[a];return(o=e.call.apply(e,[this].concat(l))||this).geocoder=null,o.cachedResult=null,o.initializeGeocoder=function(){var e=o.getMapboxMap(),r=o.getContainerNode(),t=o.props,c=t.inputValue,l=t.render,a=t.getItemValue,u=t.onInit,s=t.position,d={accessToken:t.mapboxApiAccessToken,origin:t.origin,zoom:t.zoom,flyTo:!1,placeholder:t.placeholder,proximity:t.proximity,trackProximity:t.trackProximity,collapsed:t.collapsed,clearAndBlurOnEsc:t.clearAndBlurOnEsc,clearOnBlur:t.clearOnBlur,bbox:t.bbox,types:t.types,countries:t.countries,minLength:t.minLength,limit:t.limit,language:t.language,filter:t.filter,localGeocoder:t.localGeocoder,reverseGeocode:t.reverseGeocode,enableEventLogging:t.enableEventLogging,marker:!1};l&&"function"==typeof l&&(d.render=l),a&&"function"==typeof a&&(d.getItemValue=a),o.geocoder=new n(d),o.subscribeEvents(),r?r.appendChild(o.geocoder.onAdd(e)):e.addControl(o.geocoder,i.find(function(e){return s===e})),null!=c?o.geocoder.setInput(c):o.cachedResult&&o.geocoder.setInput(o.cachedResult.place_name),(o.cachedResult||null!=c)&&o.showClearIcon(),u(o.geocoder)},o.showClearIcon=function(){o.geocoder._clearEl.style.display="block"},o.getMapboxMap=function(){var e=o.props.mapRef;return e&&e.current&&e.current.getMap()||null},o.getContainerNode=function(){var e=o.props.containerRef;return e&&e.current||null},o.subscribeEvents=function(){o.geocoder.on("clear",o.handleClear),o.geocoder.on("loading",o.handleLoading),o.geocoder.on("results",o.handleResults),o.geocoder.on("result",o.handleResult),o.geocoder.on("error",o.handleError)},o.unsubscribeEvents=function(){o.geocoder.off("clear",o.handleClear),o.geocoder.off("loading",o.handleLoading),o.geocoder.off("results",o.handleResults),o.geocoder.off("result",o.handleResult),o.geocoder.off("error",o.handleError)},o.removeGeocoder=function(){var e=o.getMapboxMap();o.unsubscribeEvents(),e&&e.removeControl&&o.getMapboxMap().removeControl(o.geocoder),o.geocoder=null},o.handleClear=function(){o.cachedResult=null,o.props.onClear()},o.handleLoading=function(e){o.props.onLoading(e)},o.handleResults=function(e){o.props.onResults(e)},o.handleResult=function(e){var n=e.result,i=o.props,c=i.onViewportChange,l=i.onResult,a=n.bbox,u=n.center,s=n.properties,d=(void 0===s?{}:s).short_code,p=u[0],g=u[1],f={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}},m=o.getMapboxMap().getContainer().getBoundingClientRect(),h=m.width,b=m.height,v=o.geocoder.options.zoom,x=function(e,o){return new t(o).fitBounds(e)};try{!f[d]&&a?v=x([[a[0],a[1]],[a[2],a[3]]],{width:h,height:b}).zoom:f[d]&&(v=x(f[d].bbox,{width:h,height:b}).zoom)}catch(e){console.warn("following result caused an error when trying to zoom to bbox: ",n),v=o.geocoder.options.zoom}c({longitude:p,latitude:g,zoom:v,transitionInterpolator:new r,transitionDuration:3e3}),l(e),o.cachedResult=n,o.geocoder._typeahead.selected=null,o.showClearIcon()},o.handleError=function(e){o.props.onError(e)},o}c=e,(o=l).prototype=Object.create(c.prototype),o.prototype.constructor=o,o.__proto__=c;var a=l.prototype;return a.componentDidMount=function(){this.initializeGeocoder()},a.componentWillUnmount=function(){this.removeGeocoder()},a.componentDidUpdate=function(){this.removeGeocoder(),this.initializeGeocoder()},a.getGeocoder=function(){return this.geocoder},a.render=function(){return null},l}(e);c.propTypes={mapRef:o.object.isRequired,containerRef:o.object,onViewportChange:o.func,mapboxApiAccessToken:o.string.isRequired,inputValue:o.string,origin:o.string,zoom:o.number,placeholder:o.string,proximity:o.object,trackProximity:o.bool,collapsed:o.bool,clearAndBlurOnEsc:o.bool,clearOnBlur:o.bool,bbox:o.array,types:o.string,countries:o.string,minLength:o.number,limit:o.number,language:o.string,filter:o.func,localGeocoder:o.func,reverseGeocode:o.bool,enableEventLogging:o.bool,render:o.func,getItemValue:o.func,position:o.oneOf(i),onInit:o.func,onClear:o.func,onLoading:o.func,onResults:o.func,onResult:o.func,onError:o.func},c.defaultProps={onViewportChange:function(){},origin:"https://api.mapbox.com",zoom:16,placeholder:"Search",trackProximity:!1,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,minLength:2,limit:5,reverseGeocode:!1,enableEventLogging:!0,position:"top-right",onInit:function(){},onClear:function(){},onLoading:function(){},onResults:function(){},onResult:function(){},onError:function(){}};export default c;
//# sourceMappingURL=index.m.js.map
